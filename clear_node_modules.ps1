function Clear-NodeModules-Recursive () {
    param ($dir)

    $node_modules = [System.IO.Path]::GetFullPath((Join-Path $dir "./node_modules"))
    if ([System.IO.Directory]::Exists($node_modules)) {
        Write-Host "$node_modules ..."
        & Remove-Item -LiteralPath $node_modules -Force -Recurse
    }

    $subDirs = Get-ChildItem -Path $dir -Directory -Force -ErrorAction SilentlyContinue
    foreach ($subDir in $subDirs) {
        Clear-NodeModules-Recursive -dir $subDir
    }
}

Write-Host -f Green `
"`n==================================" `
"`n=== Deleting node_modules...   ===" `
"`n==================================`n"

$workDir = Get-Location

$root = $PSScriptRoot
Set-Location $root

Clear-NodeModules-Recursive -dir $root

Set-Location $workDir
